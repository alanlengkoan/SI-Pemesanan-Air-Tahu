<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Air Tahu | {% block title %}Selamat Datang!{% endblock %}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="icon" type="image/x-icon" href="{{ asset('assets/admin/images/logo.png') }}">
    
    {# begin:: asset public css #}
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Spectral:ital,wght@0,200;0,300;0,400;0,500;0,700;0,800;1,200;1,300;1,400;1,500;1,700&display=swap">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/simple-line-icons/2.4.1/css/simple-line-icons.css">
    <link rel="stylesheet" href="{{ asset('assets/user/css/animate.css') }}">
    <link rel="stylesheet" href="{{ asset('assets/user/css/owl.carousel.min.css') }}">
    <link rel="stylesheet" href="{{ asset('assets/user/css/owl.theme.default.min.css') }}">
    <link rel="stylesheet" href="{{ asset('assets/user/css/magnific-popup.css') }}">
    <link rel="stylesheet" href="{{ asset('assets/user/css/flaticon.css') }}">
    <link rel="stylesheet" href="{{ asset('assets/user/css/style.css') }}">
    {# end:: asset public css #}

    <style>
    .parsley-errors-list {
        color: red;
        list-style-type: none;
        padding: 0;
    }
    </style>
    {% block stylesheets %}{% endblock %}

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
</head>

<body>
    {# begin:: navbar head #}
    <div class="wrap">
        <div class="container">
            <div class="row">
                <div class="col-md-6 d-flex align-items-center">
                    <p class="mb-0 phone pl-md-2">
                        <a href="#" class="mr-2"><span class="fa fa-phone mr-1"></span>+62 823-8577-2148</a>
                        <a href="#"><span class="fa fa-paper-plane mr-1"></span>an.three20@gmail.com</a>
                    </p>
                </div>
                <div class="col-md-6 d-flex justify-content-md-end">
                    <div class="social-media mr-4">
                        <p class="mb-0 d-flex">
                            <a href="https://m.facebook.com/airtahusuper/?ref=bookmarks" target="_blank" class="d-flex align-items-center justify-content-center">
                                <span class="fa fa-facebook"><i class="sr-only">Facebook</i></span>
                            </a>
                            <a href="https://www.instagram.com/airtahusuper" target="_blank" class="d-flex align-items-center justify-content-center">
                                <span class="fa fa-instagram"><i class="sr-only">Instagram</i></span>
                            </a>
                        </p>
                    </div>
                    <div class="reg">
                        {% if app.user %}
                            <p class="mb-0">
                                <a href="{{ path('profil') }}" class="mr-2">Profil</a>
                                <a href="{{ path('app_logout') }}">Keluar</a>
                            </p>
                        {% else %}
                            <p class="mb-0"> <a href="{{ path('register') }}" class="mr-2">Daftar</a> <a href="{{ path('login_user') }}">Masuk</a></p>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>
    {# end:: navbar head #}

    {# begin:: navbar #}
    <nav class="navbar navbar-expand-lg navbar-dark ftco_navbar bg-dark ftco-navbar-light" id="ftco-navbar">
        <div class="container">
            <a class="navbar-brand" href="/">Air Tahu <span>Super</span></a>
            <div class="order-lg-last btn-group">
                <a href="{{ path('keranjang') }}" class="btn-cart dropdown-toggle dropdown-toggle-split">
                    <span class="flaticon-shopping-bag"></span>
                    <div class="d-flex justify-content-center align-items-center"><small>{{ (app.user) ? app.user.id_users|count : '0' }}</small></div>
                </a>
            </div>

            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#ftco-nav"
                aria-controls="ftco-nav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="oi oi-menu"></span> Menu
            </button>

            <div class="collapse navbar-collapse" id="ftco-nav">
                {% set current_path = app.request.get('_route') %}
                <ul class="navbar-nav ml-auto">
                    <li class="{{ (current_path == 'index') ? 'active' : '' }} nav-item">
                        <a class="nav-link" href="/">Beranda</a>
                    </li>
                    <li class="{{ (current_path == 'tentang') ? 'active' : '' }} nav-item">
                        <a class="nav-link" href="{{ path('tentang') }}">Tentang</a>
                    </li>
                    <li class="{{ (current_path == 'kontak') ? 'active' : '' }} nav-item">
                        <a class="nav-link" href="{{ path('kontak') }}">Kontak</a>
                    </li>
                    <li class="{{ (current_path == 'produk_sel') ? 'active' : '' }} nav-item">
                        <a class="nav-link" href="{{ path('produk_sel') }}">Produk</a>
                    </li>
                    {% if app.user %}
                    <li class="{{ (current_path == 'riwayat') ? 'active' : '' }} nav-item">
                        <a class="nav-link" href="{{ path('riwayat') }}">Riwayat</a>
                    </li>
                    {% endif %}
                </ul>
            </div>
        </div>
    </nav>
    {# end:: navbar #}

    {# begin:: body #}
    {% block body %}{% endblock %}
    {# end:: body #}

    {# begin:: footer #}
    <footer class="ftco-footer">
        <div class="container">
            <div class="row mb-5">
                <div class="col-sm-12 col-md">
                    <div class="ftco-footer-widget mb-4">
                        <h2 class="ftco-heading-2 logo"><a href="#">Air Tahu <span>Super</span></a></h2>
                        <p>Silahkan cari kami di :</p>
                        <ul class="ftco-footer-social list-unstyled mt-2">
                            <li class="ftco-animate"><a href="https://m.facebook.com/airtahusuper/?ref=bookmarks" target="_blank"><span class="fa fa-facebook"></span></a></li>
                            <li class="ftco-animate"><a href="https://www.instagram.com/airtahusuper" target="_blank"><span class="fa fa-instagram"></span></a></li>
                        </ul>
                    </div>
                </div>
                <div class="col-sm-12 col-md">
                    <div class="ftco-footer-widget mb-4 ml-md-4">
                        <h2 class="ftco-heading-2">Informasi</h2>
                        <ul class="list-unstyled">
                            <li><a href="{{ path('produk_sel') }}"><span class="fa fa-chevron-right mr-2"></span>Produk</a></li>
                            <li><a href="{{ path('tentang') }}"><span class="fa fa-chevron-right mr-2"></span>Tentang</a></li>
                            <li><a href="{{ path('kontak') }}"><span class="fa fa-chevron-right mr-2"></span>Kontak</a></li>
                        </ul>
                    </div>
                </div>
                <div class="col-sm-12 col-md">
                    <div class="ftco-footer-widget mb-4">
                        <h2 class="ftco-heading-2">Ada pertanyaan?</h2>
                        <div class="block-23 mb-3">
                            <ul>
                                <li><span class="icon fa fa-map marker"></span><span class="text">Jl. Ade Irma Nasution No. 14B, Ujung Pandang Baru, Kec. Tallo, Kota Makassar, Sulawesi Selatan 90215.</p></span></li>
                                <li><a href="#"><span class="icon fa fa-phone"></span><span class="text">+62 823-8577-2148</span></a></li>
                                <li><a href="#"><span class="icon fa fa-paper-plane pr-4"></span><span class="text">an.three20@gmail.com</span></a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="container-fluid px-0 py-5 bg-black">
            <div class="container">
                <div class="row">
                    <div class="col-md-12">

                        <p class="mb-0" style="color: rgba(255,255,255,.5);">
                            Copyright &copy;
                            <script>
                                document.write(new Date().getFullYear());
                            </script>
                            <a href="https://alanlengkoan.netlify.app/" target="_blank">AL</a> - Sistem Informasi Penjualan Air Tahu.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </footer>
    {# end:: footer #}

    {# begin:: loader #}
    <div id="ftco-loader" class="show fullscreen"><svg class="circular" width="48px" height="48px">
        <circle class="path-bg" cx="24" cy="24" r="22" fill="none" stroke-width="4" stroke="#eeeeee" />
        <circle class="path" cx="24" cy="24" r="22" fill="none" stroke-width="4" stroke-miterlimit="10" stroke="#F96D00" /></svg>
    </div>
    {# end:: loader #}

    {# begin:: beri rating #}
    <div class="modal fade" id="modalRating" tabindex="-1" role="dialog">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h6>Status Pemesanan</h6>
                </div>
                <div class="modal-body">
                    <div class="row text-center pt-2">
                        <div class="col-12">
                            <h2 style="margin-bottom: 10px; font-size: 25px;">Pesanan telah diterima</h2>
                            <form id="form-submit" action="{{ path('submit_rating') }}" method="post">
                                <input type="hidden" name="id_users" id="id_users" />
                                <input type="hidden" name="kd_pemesanan" id="kd_pemesanan" />

                                <p style="margin-bottom: 0; text-align: left;">Beri rating :</p>
                                <div class="row justify-content-center">
                                    <div class="col-7 col-sm-5 col-md-5 col-lg-5">
                                        <div class="rating">
                                            <input type="radio" name="bintang" id="bintang1" value="5"><label for="bintang1"></label>
                                            <input type="radio" name="bintang" id="bintang2" value="4"><label for="bintang2"></label>
                                            <input type="radio" name="bintang" id="bintang3" value="3"><label for="bintang3"></label>
                                            <input type="radio" name="bintang" id="bintang4" value="2"><label for="bintang4"></label>
                                            <input type="radio" name="bintang" id="bintang5" value="1"><label for="bintang5"></label>
                                        </div>
                                    </div>
                                </div>
                                <p style="margin-bottom: 0; text-align: left;">Punya saran buat kami ?</p>
                                <div class="form-group">
                                    <textarea class="form-control" name="komentar" id="komentar" rows="5" cols="5"></textarea>
                                </div>
                                <input type="submit" name="submit" value="Selesai" class="btn btn-primary" data-dismiss="modalRating">
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    {# end:: beri rating #}

    {# begin:: asset public js #}
    <script src="{{ asset('assets/user/js/jquery.min.js') }}"></script>
    <script src="{{ asset('assets/user/js/jquery-migrate-3.0.1.min.js') }}"></script>
    <script src="{{ asset('assets/user/js/popper.min.js') }}"></script>
    <script src="{{ asset('assets/user/js/bootstrap.min.js') }}"></script>
    <script src="{{ asset('assets/user/js/jquery.easing.1.3.js') }}"></script>
    <script src="{{ asset('assets/user/js/jquery.waypoints.min.js') }}"></script>
    <script src="{{ asset('assets/user/js/jquery.stellar.min.js') }}"></script>
    <script src="{{ asset('assets/user/js/owl.carousel.min.js') }}"></script>
    <script src="{{ asset('assets/user/js/jquery.magnific-popup.min.js') }}"></script>
    <script src="{{ asset('assets/user/js/jquery.animateNumber.min.js') }}"></script>
    <script src="{{ asset('assets/user/js/scrollax.min.js') }}"></script>
    <script src="{{ asset('assets/user/js/main.js') }}"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/parsley.js/2.9.2/parsley.min.js"></script>
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
    {# end:: asset public js #}

    <script>
        load_rating()

        function load_rating() {
            $.ajax({
                type: 'GET',
                url: '/user/load_rating',
                dataType: 'json',
                success: function (response) {
                    const pemesanan = response.pemesanan;
                    pemesanan.forEach(function (object) {
                        $('#id_users').val(object.id_users);
                        $('#kd_pemesanan').val(object.kd_pemesanan);
                        $('#modalRating').modal({
                            backdrop: 'static',
                            keyboard: false
                        });
                    });
                },
                error: function (xhr, ajaxOptions, thrownError) {
                    var errorMsg = 'Request Ajax Gagal : ' + xhr.responseText;
                    console.log(errorMsg);
                }
            });
        }

        // untuk submit rating
        var untukSubmitRating = function() {
        $('#form-submit').submit(function(e) {
            e.preventDefault();

            $('#komentar').attr('required', 'required');

            if ($('#form-submit').parsley().isValid() == true) {
                $.ajax({
                    method: $(this).attr('method'),
                    url: $(this).attr('action'),
                    data: new FormData(this),
                    contentType: false,
                    processData: false,
                    dataType: 'json',
                    beforeSend: function() {},
                    success: function(data) {
                        swal({
                            title: data.title,
                            text: data.text,
                            icon: data.type,
                            button: data.button,
                        })
                        .then((value) => {
                            location.reload();
                        });
                    }
                })
            }
        });
    }();
    </script>

    {% block javascripts %}{% endblock %}
</body>

</html>