{% extends 'layout.html.twig' %}

{% block title %}Detail Nota{% endblock %}

{% block body %}
{# begin:: background #}
<section class="hero-wrap hero-wrap-2" style="background-image: url('{{ asset('assets/user/images/tahu.jpg') }}');" data-stellar-background-ratio="0.5">
    <div class="overlay"></div>
    <div class="container">
        <div class="row no-gutters slider-text align-items-end justify-content-center">
            <div class="col-md-9 ftco-animate mb-5 text-center">
                <h2 class="mb-0 bread">Detail Nota</h2>
            </div>
        </div>
    </div>
</section>
{# end:: background #}

<section class="ftco-section">
    <div class="container">
        <div class="row">
            <div class="col-6">
                <div class="row align-items-end">
                    <div class="col-md-6">
                        <div class="form-group">
                            <h5>Kode Order</h5>
                            <input type="text" class="form-control-plaintext" placeholder="{{ data_pemesanan.kd_pemesanan }}" readonly>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <h5>Nama</h5>
                            <input type="text" class="form-control-plaintext" placeholder="{{ data_pemesanan.nama }}" readonly>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <h5>Email</h5>
                            <input type="email" class="form-control-plaintext" placeholder="{{ data_pemesanan.email }}" readonly>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <h5>No. Telepon</h5>
                            <input type="number" class="form-control-plaintext" placeholder="{{ data_pemesanan.telepon }}" readonly>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <h5>Jenis Kelamin</h5>
                            <input type="text" class="form-control-plaintext" placeholder="{{ (data_pemesanan.kelamin == 'L') ? 'Laki - laki' : 'Perempuan' }}" readonly>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <h5>Alamat</h5>
                            <input type="text" class="form-control-plaintext" placeholder="{{ data_pemesanan.alamat }}" readonly>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <h5>Tanggal Pemesanan</h5>
                            <input type="text" class="form-control-plaintext" placeholder="{{ data_pemesanan.tgl_pemesanan|date('d-m-Y') }}" readonly>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <h5>Jam Pemesanan</h5>
                            <input type="text" class="form-control-plaintext" placeholder="{{ data_pemesanan.tgl_pemesanan|date('H:i:s') }}" readonly>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-6">
                <div class="row">
                    <div class="cart-detail cart-total p-3 p-md-4">
                        <h3 class="billing-heading mb-4">Pembayaran</h3>
                        <p class="d-flex">
                            <span>Metdoe Pembayaran</span>
                            <span>{{ (data_pemesanan.metode_pembayaran == 'c') ? 'COD' : 'Transfer' }}</span>
                        </p>
                        <p class="d-flex">
                            <span>Status Pembayaran</span>
                            <span>{{ (data_pemesanan.status_pembayaran == 0) ? 'Menunggu Pembayaran' : 'Telah Melakukan Pembayaran' }}</span>
                        </p>

                        {% if data_pemesanan.metode_pembayaran == 't' %}
                            <p class="d-flex">
                                <span>Bank</span>
                                <span>{{ data_pembayaran_detail.nama }}</span>
                            </p>
                            <p class="d-flex">
                                <span>Nomor Rekening</span>
                                <span>{{ data_pembayaran_detail.rekening }}</span>
                            </p>
                            <p class="d-flex">
                                <span>Nama Penyetor</span>
                                <span>{{ (data_pembayaran_detail.nama_penyetor == null) ? '-' : data_pembayaran_detail.nama_penyetor }}</span>
                            </p>
                            <p class="d-flex">
                                <span>Atas Nama</span>
                                <span>{{ (data_pembayaran_detail.atas_nama == null) ? '-' : data_pembayaran_detail.atas_nama }}</span>
                            </p>
                            <p class="d-flex">
                                <span>Tanggal Transfer</span>
                                <span>{{ (data_pembayaran_detail.tanggal_transfer == null) ? '-' : data_pembayaran_detail.tanggal_transfer|date('d-m-Y') }}</span>
                            </p>
                            <p class="d-flex">
                                <span>Jam Transfer</span>
                                <span>{{ (data_pembayaran_detail.tanggal_transfer == null) ? '-' : data_pembayaran_detail.tanggal_transfer|date('H:i:s') }}</span>
                            </p>
                            <p class="d-flex">
                                <span>Bukti Transfer</span>
                                <span>{% if (data_pembayaran_detail.bukti == null) %} - {% else %} <img
                                        src="{{ asset('uploads/bukti/'~data_pembayaran_detail.bukti) }}" width="100"
                                        heigth="100" /> {% endif %}</span>
                            </p>
                            <hr>
                            <p class="d-flex total-price">
                                <span>Jumlah Transfer</span>
                                <span>{{ (data_pembayaran_detail.jumlah_transfer == null) ? '-' : data_pembayaran_detail.jumlah_transfer|format_rp }}</span>
                            </p>
                            {% if data_pemesanan.status_pembayaran == '0' %}
                            <tr>
                                <td>
                                    <a href="/user/transfer/{{ data_pemesanan.kd_pemesanan }}">Transfer</a>
                                </td>
                            </tr>
                            {% endif %}
                        {% elseif data_pemesanan.metode_pembayaran == 'c' %}
                            <p class="d-flex">
                                <span>Nama Bayar</span>
                                <span>{{ (data_pembayaran_cod.nama_bayar == null) ? '-' : data_pembayaran_cod.nama_bayar }}</span>
                            </p>
                            <p class="d-flex">
                                <span>Jumlah Bayar</span>
                                <span>{{ (data_pembayaran_cod.jumlah_bayar == null) ? '-' : data_pembayaran_cod.jumlah_bayar|format_rp }}</span>
                            </p>
                            <p class="d-flex">
                                <span>Tanggal Bayar</span>
                                <span>{{ (data_pembayaran_cod.tanggal_bayar == null) ? '-' : data_pembayaran_cod.tanggal_bayar|date('d-m-Y') }}</span>
                            </p>
                            <p class="d-flex">
                                <span>Jam Bayar</span>
                                <span>{{ (data_pembayaran_cod.tanggal_bayar == null) ? '-' : data_pembayaran_cod.tanggal_bayar|date('H-i-s') }}</span>
                            </p>
                        {% endif %}
                    </div>
                </div>
            </div>

            <table class="table border">
                <thead class="thead-primary">
                    <tr>
                        <th>No.</th>
                        <th>&nbsp;</th>
                        <th>Nama</th>
                        <th>Jumlah</th>
                        <th>Harga</th>
                        <th>Sub Total</th>
                    </tr>
                </thead>
                <tbody>
                    {% set sum = 0 %}
                    {% for rows in data_pemesanan_detail %}
                    {% set sum = sum + rows.sub_total  %}
                    <tr>
                        <td>{{ loop.index }}</td>
                        <td><img src="{{ asset('uploads/produk/'~rows.gambar) }}" width="100" heigth="100" /></td>
                        <td>
                            {{ rows.nama }}
                        </td>
                        <td>
                            {{ rows.jumlah }}
                        </td>
                        <td>
                            {{ rows.harga|format_rp }}
                        </td>
                        <td>
                            <span id="sub-total">{{ rows.sub_total|format_rp }}</span>
                        </td>
                    </tr>
                    {% endfor %}
                    <tr>
                        <td colspan="5" align="center">
                            Total
                        </td>
                        <td align="center">
                            <span id="total">{{ sum|format_rp }}</span>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="5" align="center">
                            Grand Total
                        </td>
                        <td align="center">
                            <span id="total">{{ sum|format_rp }}</span>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="6" align="center">
                            <button class="btn btn-primary py-2 px-4" type="button" data-id="{{ data_pemesanan.kd_pemesanan }}" id="cetak"> Cetak </button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
    </div>
</section>
{% endblock %}

{% block javascripts %}
<script>
    // untuk cetak
    var untukGetIdData = function() {
        $(document).on('click', '#cetak', function () {
            var ini = $(this);
            var id = ini.data('id');

            window.location = '/user/cetak/' + id;
        });
    }();
</script>
{% endblock %}