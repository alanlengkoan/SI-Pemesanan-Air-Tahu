<link href="{{ asset('assets/admin/extra-libs/datatables.net-bs4/css/dataTables.bootstrap4.css') }}" rel="stylesheet" />

<div class="table-responsive">
    <table id="tabel_laporan" class="table table-striped table-bordered display no-wrap" style="width:100%">
        <thead>
            <tr>
                <th>Kode Order</th>
                <th>Nama</th>
                <th>Tanggal Pembelian</th>
                <th>Jam Pembelian</th>
                <th>Total Pembelian</th>
                <th>Total Bayar</th>
            </tr>
        </thead>
        <tbody>
        {% set tot_pembelian = 0 %}
        {% set tot_bayar = 0 %}

        {% for key, value in data %}
            <tr>
                <td rowspan="{{ value|length + 1 }}">{{ key }}</td>
                {% for rows in value %}
                    {% set tot_pembelian = tot_pembelian + rows.total_pembelian  %}
                    {% set tot_bayar = tot_bayar + rows.total_bayar  %}
                    <tr>
                        <td>{{ rows.kode_order }}</td>
                        <td>{{ rows.tanggal_pembelian }}</td>
                        <td>{{ rows.jam_pembelian }}</td>
                        <td>{{ rows.total_pembelian|format_rp }}</td>
                        <td>{{ rows.total_bayar|format_rp }}</td>
                    </tr>
                {% endfor %}
            </tr>
        {% endfor %}
        </tbody>
        <tfoot>
            <tr>
                <th colspan="4" style="text-align: center;">Total</th>
                <th>{{ tot_pembelian|format_rp }}</th>
                <th>{{ tot_bayar|format_rp }}</th>
            </tr>
        </tfoot>
    </table>
</div>

<script src="{{ asset('assets/admin/extra-libs/datatables.net/js/jquery.dataTables.min.js') }}"></script>
<script src="{{ asset('assets/admin/dist/js/pages/datatable/datatable-basic.init.js') }}"></script>

<script>
    var untukDataTabel = function () {
        $('#tabel_laporan').DataTable();
    }();
</script>